/* http://en.wikipedia.org/wiki/Kory%C5%AB */
abstract low_skill fighting_skill {
    default_intrinsic 0.2;
    default_familiarity 0.0;

    associated_attribute strength;
    attribute_scaling 0.2;

    class optional sym japanese_name;

    class_many optional sym weapons;
}

/* Used for animals that fight on instinct. */
fighting_skill intrinsic_fighting {}

/* Yes, karate and kendo did not exist until the 20th century. Too bad! */
fighting_skill empty_hand_fighting_skill {
    japanese_name karate;
    weapons hand leg;
}

fighting_skill sword_skill {
    japanese_name kendo;
    weapons sword;
    /* TODO - paractice kata */
}

/* grappling, holds, kicking */
fighting_skill grappling_skill {
    japanese_name jujutsu;
    weapons hand leg;
}

fighting_skill staff_skill {
    japanese_name bojutsu;
    weapons longstaff;
    /* TODO - practice kata */
}

fighting_skill short_staff_skill {
    japanese_name jojutsu;
    weapons shortstaff halfstaff;
    /* TODO - practice kata */
}

/* using jutte, disarmament, non-lethal, apprehension / blocking, deflecting, grappling swords */
fighting_skill juttejutsu {
    japanese_name juttejutsu;
    weapons jutte;
}

fighting_skill glaive_skill {
    japanese_name naginatajutsu;
    weapons glaive;
}

/* kobudō, a generic term for the systems of Okinawan martial arts weapons, was not invented until the 20th century. */
fighting_skill sai_skill {
    weapons sai;
}

fighting_skill nunchucks_skill {
    japanese_name nunchaku_skill;
    weapons nunchucks;
}

/* yari spear used by ashigaru (lightfeet) */
fighting_skill spear_skill {
    japanese_name sojutsu;
    weapons spear;
}

fighting_skill knife_skill {
    japanese_name tantōjutsu;
    weapons dagger;
}

fighting_skill two-sword_skill {
    japanese_name nitōryū;
    weapons katana wakizashi;
}

fighting_skill bow_skill {
    japanese_name kyūjutsu;
    weapons short_bow long_bow;
}

fighting_skill matchlock_skill {
    japanese_name tanegashimajutsu; /* ?? */
    weapons matchlock;
}

fighting_skill chain_and_sickle_skill {
    japanese_name kusarigamajutsu;
    weapons chain_and_sickle;
}

fighting_skill hammer_skill {
    weapons hammer;
}

post_process {
    Log.debug("Propagating component information for martial arts skill", 6)
    types_of(:fighting_skill, true).each do |skill|
        weapons = info_for(skill, :weapons)
        if !(weapons.nil? || weapons.empty?)
            weapons.each do |weapon|
                if has_type?(weapon)
                    Log.debug("#{weapon} is used in #{skill}")
                    name = :skill_used
                    # This is going to become a performance issue later
                    modify_info(weapon, name, []) << skill
                    modify_info(weapon, name).uniq!
                else
                    Log.error("#{weapon.inspect} not defined as db type")
                end
            end
        end
    end
}

